# frozen_string_literal: false
#!/usr/bin/env ruby
require 'csi'
require 'thread'
require 'optparse'

opts = {}
OptionParser.new do |options|
  options.banner = "USAGE:
    #{$0} [opts]
  "

  options.on('-tURL', '--target=URL', '<Required - URL to Target>') {|t| opts[:target] = t }
  options.on('-bBURP', '--burp-jar-path=BURP', '<Required - Path to Burpsuite Jar>') {|b| opts[:burp_jar_path] = b }
end.parse!

if opts.empty?
  puts `#{$0} --help`
  exit 1
end

target = opts[:target].to_s.scrub
burp_jar_path = opts[:burp_jar_path].to_s.scrub

# Open Burpsuite & Obtain Listening Proxy Port to Pass into OWASP ZAP
burp_obj = CSI::Plugins::BurpSuite.start(burp_jar_path: burp_jar_path)
burp_listening_proxy_port = burp_obj[:proxy_port]

zap_obj = CSI::Plugins::OwaspZapIt.start(target: target)
